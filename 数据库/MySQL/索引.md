

___
# 主键索引和聚集索引
聚集索引确定表中数据的物理顺序，聚集索引规定数据在表中的物理存储顺序，因此一个表只能包含一个聚集索引。可以说聚集索引就是表数据自身的顺序。

主键索引的叶子节点存的是整行数据。在 InnoDB 里，主键索引也被称为聚簇索引（clustered index）。

Innodb 通过主键聚集数据
如果没有定义主键，innodb会选择非空的唯一索引代替。
如果没有这样的索引，innodb会隐式的定义一个主键来作为聚簇索引

## 自增主键好处
B+ 树为了维护索引有序性，在插入新值的时候需要做必要的维护。如果插入的值比最大值id大，则只需要最后记录后面插入一个新记录。如果新插入的ID值在原先的有序中间，就相对麻烦了，需要逻辑上挪动后面的数据，空出位置。如果所在的数据页已经满了，根据 B+ 树的算法，这时候需要申请一个新的数据页，然后挪动部分数据过去。这个过程称为页分裂。在这种情况下，性能自然会受影响。
除了性能外，页分裂操作还影响数据页的利用率。原本放在一个页的数据，现在分到两个页中，整体空间利用率降低大约 50%。
当然有分裂就有合并。当相邻两个页由于删除了数据，利用率很低之后，会将数据页做合并。合并的过程，可以认为是分裂过程的逆过程。

___
# 非主键索引
非主键索引的叶子节点内容是主键的值。在 InnoDB 里，非主键索引也被称为二级索引（secondary index）。

___
# 主键索引和唯一索引的区别
* 一个表的主键只能有一个，而唯一索引可以建多个。
* 主键不可为 null ，唯一索引列的值可以为 null 。
* 主键索引的叶子节点是数据，唯一索引的叶子节点内容是主键的值。

___
# 聚集索引和非聚集索引的区别
* 一个表的聚集索引只能有一个，而非聚集索引索引可以建多个。
* 聚集索引不可为 null ，非聚集索引值可以为 null 。
* 聚集索引的叶子节点是数据，非聚集索引的叶子节点内容是主键的值。

___
# 索引失效
- like 以%开头索引无效，当 like 以&结尾，索引有效。
36
- or 语句前后没有同事使用索引，当且仅当 or 语句查询条件的前后列均为索引时，索引生
效。
- 组合索引，使用的不是第一列索引时候，索引失效，即最左匹配规则。
- 数据类型出现**隐式转换**，如 varchar 不加单引号的时候可能会自动转换为 int 类型，这个
时候索引失效。
- **在索引列上使用 IS NULL 或者 IS NOT NULL 时候，索引失效，因为索引是不索引空值
得**
- 在索引字段上使用，NOT、 <>、！= 、时候是不会使用索引的，对于这样的处理只会进
行全表扫描。
- 对索引字段进行**计算操作**，函数操作时不会使用索引，如 `WHERE id+1=5`
- 当全表扫描速度比索引速度快的时候不会使用索引。