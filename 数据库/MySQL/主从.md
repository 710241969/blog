___
# 复制类型

## 基于语句的复制 statement
在Master上执行的SQL语句，在Slave上执行同样的语句。MySQL默认采用基于语句的复制，效率比较高。一旦发现没法精确复制时，会自动选着基于行的复制

## 基于行的复制 row

把改变的内容复制到Slave，而不是把命令在Slave上执行一遍。从MySQL5.0开始支持
## 混合类型的复制 mixed
默认采用基于语句的复制，一旦发现基于语句的无法精确的复制时，就会采用基于行的复制

___
# 同步模式

## 异步复制
异步复制是mysql 默认的同步方式。

在master为slave开通账号密码、ip授权之后，slave 可以从master进行数据同步，主要依赖的是master的binlog日志。

slave 会启动两个线程，IO Thread 和 SQL Thread。IO Thread 负责从master拉取binlog 日志，并写入relay中继日志。SQL Thread 负责将relay中继日志中的变更进行重放，更新数据来达到跟master保持数据一致的目的。这个过程中，slave通过IO线程拉取binlog，master无需关注是否有slave需要同步，只做自己的事情，整个复制过程都是异步完成的，这个就是异步复制。

异步复制的优势是性能好，缺点是数据的安全性比较差。在某一刻主从之间的数据差异可能较大，主机挂掉之后从机接管，可能会丢失一部分数据。

## 半同步复制
master更新操作写入binlog之后会主动通知slave，slave接收到之后写入relay log 即可应答，master只要收到至少一个ack应答，则会提交事务。

可以发现，相比较于异步复制，半同步复制需要依赖至少一个slave将binlog写入relay log，在性能上有所降低，但是可以保证至少有一个从库跟master的数据是一致的，数据的安全性提高。

对于数据一致性要求高的场景，可以采用半同步复制的同步策略，比如主库挂掉时，准备接管的那一个从库，对数据的一致性要求很比较高。

半同步复制的优点是数据的安全性好，缺点是性能比异步复制稍低。

## 全同步复制
全同步复制跟半同步复制的区别是，全同步复制必须收到所有从库的ack，才会提交事务。

主库的事务提交依赖于后面所有的从库，这样一来性能就会明显得下降。除非是对所有从库数据一致性要求非常高的场景，否则我们一般不采用这种策略。

全同步复制的数据一致性最好，但是性能也是最差的。

